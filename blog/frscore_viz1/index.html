<!doctype html><html lang=en dir=ltr><head><meta charset=utf-8><meta http-equiv=x-ua-compatible content="IE=edge,chrome=1"><meta name=viewport content="width=device-width,initial-scale=1,shrink-to-fit=no"><meta name=generator content="Hugo 0.101.0"><title>Visualizing frscore results, part 1 | V-P Parkkinen</title><meta name=description content><meta property="og:site_name" content="V-P Parkkinen"><meta property="og:title" content="Visualizing frscore results, part 1 | V-P Parkkinen"><meta property="og:description" content><meta property="og:type" content="page"><meta property="og:url" content="/blog/frscore_viz1/"><meta property="og:locale" content="en"><meta property="og:image" content="%!s()"><meta property="twitter:card" content="summary_large_image"><meta name=twitter:image content="%!s()"><meta itemprop=name content="Visualizing frscore results, part 1"><meta itemprop=description content="This post is the first in a series of short texts about the frscore package, in which I describe upcoming changes in the package itself, and try to give some tips about how to make working with the package more convenient. This post and the next one are about visualizing the output of frscore() and frscored_cna().
Discussing with users of cna, I get the impression that the method is fairly often used specifically to discover or generate hypotheses about interactions between known causes of some outcome of interest."><meta itemprop=datePublished content="2022-09-16T00:00:00+00:00"><meta itemprop=dateModified content="2022-09-16T00:00:00+00:00"><meta itemprop=wordCount content="1024"><meta itemprop=keywords content="frscore,"><!--[if IE]><script src=//html5shiv.googlecode.com/svn/trunk/html5.js></script><![endif]--><link rel="shortcut icon" href type=image/x-icon><link rel=icon href type=image/x-icon><link rel=stylesheet href=/style.main.min.fcee94b15e4bc095399cf72a18633676d2a9213fd9acee562146c669afe90005.css integrity="sha256-/O6UsV5LwJU5nPcqGGM2dtKpIT/ZrO5WIUbGaa/pAAU=" media=screen><script src=/panelset.min.dca42702d7daf6fd31dc352efd2bcf0e4ac8c05ccaa58d9293f6177462de5d5f.js type=text/javascript></script>
<script src=/main.min.2b065c027e8468f7d7f985cce5b7b1768d82dc0130f5e2c6da80dea245d4e061.js type=text/javascript></script></head><body><div class=grid-container><header class="site-header pt4 pb2 mb4 bb b--transparent ph5 headroom z-max" role=banner><nav class="site-nav db dt-l w-100" role=navigation><a class="site-brand db dtc-l v-mid link no-underline w-100 w-33-l tc tl-l" href=/ title=Home><span class="f4 fw7">V-P Parkkinen</span></a><div class="site-links db dtc-l v-mid w-100 w-47-l tc tr-l mt3 mt0-l ttu tracked"><a class="link f6 f5-l dib pv1 ph2" href=/about/ title="About me">About</a>
<a class="link f6 f5-l dib pv1 ph2" href=/publications/ title=Publications>publications</a>
<a class="link f6 f5-l dib pv1 ph2" href=/cv.pdf title=CV>CV</a>
<a class="link f6 f5-l dib pv1 ph2 active" href=/blog/ title=Blog>Blog</a></div></nav></header><main class="page-main pa4" role=main><section class="page-content mw7 center"><article class="post-content pa0 ph4-l"><header class=post-header><h1 class="f1 lh-solid measure-narrow mb3 fw4">Visualizing frscore results, part 1</h1></header><section class="post-body pt5 pb4"><p>This post is the first in a series of short texts about the
<a href=https://cran.r-project.org/web/packages/frscore/index.html target=_blank rel=noopener><code>frscore</code></a> package, in which I describe upcoming changes in the package itself, and try to give some tips about how to make working with the package more convenient. This post and the next one are about visualizing the output of <code>frscore()</code> and <code>frscored_cna()</code>.</p><p>Discussing with users of
<a href=https://cran.r-project.org/web/packages/cna/index.html target=_blank rel=noopener><code>cna</code></a>, I get the impression that the method is fairly often used specifically to discover or generate hypotheses about interactions between known causes of some outcome of interest. That is, the primary purpose of the analysis is not to discover which individual factors are causally relevant for the outcome as such, but to study how the causes of the outcome could be grouped into distinct, causally sufficient mechanisms for the outcome.</p><p>If there is reason to believe that the causes indeed do interact as components of such mechanisms, then the analyst is probably not interested in very simple models, since such models can at best confirm what is already known: that this or that factor is causally relevant for the outcome. At the same time, at least some very simple models quite often end up with high fr-scores, because they are submodels of numerous more complex models found at higher consistency and coverage thresholds. Nonetheless, <code>frscore</code> functions can be, and apparently are being used to carry out the analyses also in these kinds of settings, and the results can (I believe&mldr;) be useful. The point of the concept of fit-robustness is to gauge how idiosyncratic the causal claims made by a model are, when compared to models obtained using different consistency and coverage thresholds, when the data contain noise. The underlying assumption is that the models that erroneously causally interpret the noise (e.g. overfit) will only be returned at specific consistency and coverage settings, and can be &ldquo;outed&rdquo; by the idiosyncratic causal attributions they make. I see no reason why this idea wouldn&rsquo;t apply when the primary interest is to discover or theorize about causal complexity, rather than discovering causal relevance, but in such a case the analyst will likely want to ignore the very simplest models even if they top the fr-score rankings.</p><p>The challenge then is to decide which models are complex enough to be interesting, but not too brittle and idiosyncratic. I have no take on how exactly these decisions should be made, but I was alerted to the fact that doing this often requires combing through the <code>frscore</code> results with some care, and this alone can be a fairly annoying task. One thing that may help here is that the results often tend to cluster: the models returned by <code>frscored_cna()</code> form &ldquo;families&rdquo;, the members of which have roughly equal scores. This is not always easy to see in the printed output of the functions, especially if there are more than twenty-ish unique model types. But it is immediately noticable if one were to visualize the scores: the distribution of the scores from the top to the bottom features some relatively flat plateaus separated by steeper downward drops, like a kinked staircase handrail. Looking closer at these plateaus one by one could then be a reasonable first step heuristic for finding the complex-enough but not-too-weird models. In any case, eyeballing the results cannot hurt.</p><p>However, plotting the scores per model type often results in a completely unreadable figure; there are just too many unique model types.
Fortunately, it is easy to make a regular <code>ggplot</code> figure interactive, so that one can zoom into regions of the plot, and retrieve information about the data points by clicking or hovering the mouse over them. Below is a short example demonstrating how this can be done using the <code>plotly</code> package.</p><div class=highlight><pre tabindex=0 style=background-color:#fff;-moz-tab-size:4;-o-tab-size:4;tab-size:4><code class=language-r data-lang=r><span style=display:flex><span><span style=color:#900;font-weight:700>library</span>(frscore)
</span></span><span style=display:flex><span><span style=color:#900;font-weight:700>library</span>(forcats)
</span></span><span style=display:flex><span><span style=color:#900;font-weight:700>library</span>(ggplot2)
</span></span><span style=display:flex><span><span style=color:#900;font-weight:700>library</span>(plotly)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># generate some frscore results with frscored_cna()</span>
</span></span><span style=display:flex><span>res <span style=color:#000;font-weight:700>&lt;-</span> <span style=color:#900;font-weight:700>frscored_cna</span>(d.error, fit.range <span style=color:#000;font-weight:700>=</span> <span style=color:#900;font-weight:700>c</span>(<span style=color:#099>.9</span>, <span style=color:#099>.6</span>),
</span></span><span style=display:flex><span>                  granularity <span style=color:#000;font-weight:700>=</span> <span style=color:#099>.05</span>,
</span></span><span style=display:flex><span>                  maxsols <span style=color:#000;font-weight:700>=</span> <span style=color:#000;font-weight:700>Inf</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># grab the frscore() results object to be plotted</span>
</span></span><span style=display:flex><span>res_frscore <span style=color:#000;font-weight:700>&lt;-</span> res[[1]]
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># plot the results. we&#39;ll use the fct_inorder() function</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># from the forcats package to prevent ggplot from</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># messing up the order of the models.</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># here we are plotting the unadjusted score --</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># change the aes(y =) argument to norm.score to</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># plot normalized scores instead</span>
</span></span><span style=display:flex><span>res_ggplot <span style=color:#000;font-weight:700>&lt;-</span> <span style=color:#900;font-weight:700>ggplot</span>(
</span></span><span style=display:flex><span>  res_frscore,
</span></span><span style=display:flex><span>  <span style=color:#900;font-weight:700>aes</span>(x <span style=color:#000;font-weight:700>=</span> <span style=color:#900;font-weight:700>fct_inorder</span>(condition),
</span></span><span style=display:flex><span>      y <span style=color:#000;font-weight:700>=</span> score,
</span></span><span style=display:flex><span>      text <span style=color:#000;font-weight:700>=</span> <span style=color:#900;font-weight:700>paste</span>(<span style=color:#d14>&#39;model:&#39;</span>, <span style=color:#900;font-weight:700>fct_inorder</span>(condition),
</span></span><span style=display:flex><span>                   <span style=color:#d14>&#39;score:&#39;</span>, score))
</span></span><span style=display:flex><span>  ) <span style=color:#000;font-weight:700>+</span>
</span></span><span style=display:flex><span>  <span style=color:#900;font-weight:700>geom_point</span>(size <span style=color:#000;font-weight:700>=</span> <span style=color:#099>0.6</span>) <span style=color:#000;font-weight:700>+</span>
</span></span><span style=display:flex><span>  <span style=color:#900;font-weight:700>theme</span>(axis.text.x <span style=color:#000;font-weight:700>=</span> <span style=color:#900;font-weight:700>element_text</span>(size <span style=color:#000;font-weight:700>=</span> <span style=color:#099>5</span>, angle <span style=color:#000;font-weight:700>=</span> <span style=color:#099>52</span>)) <span style=color:#000;font-weight:700>+</span>
</span></span><span style=display:flex><span>  <span style=color:#900;font-weight:700>labs</span>(x <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#34;model&#34;</span>)
</span></span><span style=display:flex><span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># turn the ggplot object into an interactive plotly plot</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># where hovering over the plotted scores shows the score</span>
</span></span><span style=display:flex><span><span style=color:#998;font-style:italic># and the model</span>
</span></span><span style=display:flex><span>res_plotly <span style=color:#000;font-weight:700>&lt;-</span> <span style=color:#900;font-weight:700>ggplotly</span>(res_ggplot, tooltip <span style=color:#000;font-weight:700>=</span> <span style=color:#d14>&#34;text&#34;</span>)
</span></span><span style=display:flex><span>res_plotly
</span></span></code></pre></div><p>The figure generated by this code is shown below.
I have used the <code>d.error</code> artificial data set that comes with <code>frscore</code> in order to keep the runtime of the analysis itself short, in case you want to run the code as-is. Hence this particular plot is almost readable also as a static figure, but the point here is merely to illustrate the basic functionality of the <code>ggplot2</code>+<code>plotly</code> combo for this purpose. When the number of unique model types gets to the hundreds, you&rsquo;d start to actually benefit from the ability to zoom into specific regions of the figure. Hover over the figure to view the controls (zoom etc.) in the upper right corner. Hovering over the points displays the corresponding model, and the exact score.</p><p><script src=https://cdn.plot.ly/plotly-latest.min.js></script><div id=/frscore_viz1/frscore1.json class=plotly style=height:500px></div><script>Plotly.d3.json("/frscore_viz1/frscore1.json",function(e,t){Plotly.plot("/frscore_viz1/frscore1.json",t.data,t.layout,{responsive:!0})})</script></p><p>This plot is obviously not very pretty, but it is something that I would imagine quickly doing to help inspect the results of <code>frscore()</code> and <code>frscored_cna()</code> when the number of unique model types is large. Please have a look at the documentation of <code>ggplot2</code> and <code>plotly</code> packages to learn how to customize your own figures.</p><p>The next post will be about inspecting and visualizing networks of submodel relations between CNA models. Doing that will require a few tweaks to the <code>frscore()</code> function, such that it returns an appropriate network representation of the results in addition to the results table that it currently returns. These changes will be introduced to the
<a href=https://github.com/vpparkkinen/frscore target=_blank rel=noopener>development version</a> of the package as soon as I manage to get them done, followed by the blog post.</p><details closed class="f6 fw7 input-reset"><dl class="f6 lh-copy"><dt class=fw7>Posted on:</dt><dd class="fw5 ml0">September 16, 2022</dd></dl><dl class="f6 lh-copy"><dt class=fw7>Length:</dt><dd class="fw5 ml0">5 minute read, 1024 words</dd></dl><dl class="f6 lh-copy"><dt class=fw7>Categories:</dt><dd class="fw5 ml0"><a href=/categories/frscore>frscore</a></dd></dl><dl class="f6 lh-copy"><dt class=fw7>Tags:</dt><dd class="fw5 ml0"><a href=/tags/frscore>frscore</a></dd></dl><dl class="f6 lh-copy"><dt class=fw7>See Also:</dt></dl></details></section><footer class=post-footer><div class="post-pagination dt w-100 mt4 mb2"></div></footer></article></section></main><footer class="site-footer pv4 bt b--transparent ph5" role=contentinfo><nav class="db dt-l w-100"><p class="site-copyright f7 db dtc-l v-mid w-100 w-33-l tc tl-l pv2 pv0-l mv0 lh-copy">&copy; 2022 Veli-Pekka Parkkinen
<span class=middot-divider></span>
Made using simplified <span xmlns:dct=http://purl.org/dc/terms/ property="dct:title"><a xmlns:dct=http://purl.org/dc/terms/ href=https://github.com/hugo-apero/ rel=dct:source>Hugo Ap√©ro</a></span> theme.<br></p><div class="site-social-links db dtc-l v-mid w-100 w-33-l tc pv2 pv0-l mv0"><div class=social-icon-links aria-hidden=true><a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href=https://github.com/vpparkkinen title=github target=_blank rel=noopener><i class="fab fa-github fa-lg fa-fw"></i></a>
<a class="link dib h1 w1 ml0 mr2 f6 o-90 glow" href=mailto:veli-pekka.parkkinen@uib.no title=envelope><i class="fa fa-envelope fa-lg fa-fw"></i></a></div></div><div class="site-links f6 db dtc-l v-mid w-100 w-67-l tc tr-l pv2 pv0-l mv0"></div></nav><script>var i,text,code,codes=document.getElementsByTagName("code");for(let e=0;e<codes.length;){if(code=codes[e],code.parentNode.tagName!=="PRE"&&code.childElementCount===0&&(text=code.textContent,/^\$[^$]/.test(text)&&/[^$]\$$/.test(text)&&(text=text.replace(/^\$/,"\\(").replace(/\$$/,"\\)"),code.textContent=text),/^\\\((.|\s)+\\\)$/.test(text)||/^\\\[(.|\s)+\\\]$/.test(text)||/^\$(.|\s)+\$$/.test(text)||/^\\begin\{([^}]+)\}(.|\s)+\\end\{[^}]+\}$/.test(text))){code.outerHTML=code.innerHTML;continue}e++}</script><link rel=stylesheet href=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.css integrity=sha384-RZU/ijkSsFbcmivfdRBQDtwuwVqK7GMOw6IMvKyeWL2K5UAlyp6WonmB8m7Jd0Hn crossorigin=anonymous><script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/katex.min.js integrity=sha384-pK1WpvzWVBQiP0/GjnvRxV4mOb0oxFuyRxJlk6vVw146n3egcN5C925NCP7a7BY8 crossorigin=anonymous></script>
<script defer src=https://cdn.jsdelivr.net/npm/katex@0.13.13/dist/contrib/auto-render.min.js integrity=sha384-vZTG03m+2yp6N6BNi5iM4rW4oIwk5DfcNdFfxkk9ZWpDriOkXX8voJBFrAO7MpVl crossorigin=anonymous onload=renderMathInElement(document.body)></script></footer></div></body></html>